{% extends "base.html" %}
{% load static %}

{% block title %}{{ ubicacion }} - Ubicaci√≥n - ChoriFans{% endblock %}

{% block content %}
<section class="ubicacion-detalle-container">

    <h1>{{ ubicacion }}</h1>

    {% if descripcion %}
        <p class="ubicacion-descripcion-detalle">
            {{ descripcion }}
        </p>
    {% endif %}

    <h2>Parrillas en esta ubicaci√≥n</h2>

    {% if parrillas %}
        <div class="parrillas-grid">
            {% for parrilla in parrillas %}
                <article class="parrilla-card">
                    
                    {# ============================ FOTO DE LA PARRILLA EN LA CARD- Si tiene foto_principal ‚Üí esa imagen.- Si NO tiene ‚Üí sin-foto.png desde static.============================ #}
                    <div class="parrilla-card-img">
                        {% if parrilla.foto_principal %}
                            <img
                                src="{{ parrilla.foto_principal.url }}"
                                alt="Foto de {{ parrilla.nombre }}"
                                class="parrilla-card-img-el"
                            >
                        {% else %}
                            <img
                                src="{% static 'css/img/sin-foto.png' %}"
                                alt="Foto no disponible de {{ parrilla.nombre }}"
                                class="parrilla-card-img-el parrilla-card-img--placeholder"
                            >
                        {% endif %}
                    </div>

                    {# ============================ CUERPO DE LA CARD Nombre, ubicaci√≥n, rating y descripci√≥n.============================ #}
                    <div class="parrilla-card-body">
                        <h3 class="parrilla-card-titulo">{{ parrilla.nombre }}</h3>

                        <p class="parrilla-card-ubicacion">
                            {{ parrilla.ubicacion.nombre_barrio }} - {{ parrilla.ubicacion.nombre_ciudad }}
                        </p>

                        <div class="parrilla-card-rating">
                            {% with puntaje=parrilla.promedio_puntaje|default:0 %}
                                {% with entero=puntaje|floatformat:0 %}
                                    <div class="puntaje-promedio-iconos">
                                        {% for i in "12345" %}
                                            {% if forloop.counter <= entero|add:"0" %}
                                                <span class="chori chori--lleno">üå≠</span>
                                            {% else %}
                                                <span class="chori chori--gris">üå≠</span>
                                            {% endif %}
                                        {% endfor %}
                                    </div>
                                {% endwith %}
                            {% endwith %}
                        </div>

                        <p class="parrilla-card-descripcion">
                            {{ parrilla.descripcion|truncatechars:120 }}
                        </p>

                        <a href="{% url 'parrillas:detalle' parrilla.id %}" class="btn-ver">Ver m√°s</a>
                    </div>
                </article>
            {% endfor %}
        </div>

    {% else %}
        <p>No hay parrillas cargadas para esta ubicaci√≥n.</p>
    {% endif %}

    <p class="volver-box">
        <a href="{% url 'ubicaciones:lista' %}" class="volver-btn">‚Üê Volver</a>
    </p>

</section>
{% endblock %}
